================================================================================
FASE 2: BACKTESTING Y OPTIMIZACIÓN - ITERACIÓN 10.1 (CON STOP LOSS)
ESTRATEGIA: Confluencia de 3 Capas (Módulo Alcista v1) + SL Dinámico ATR
================================================================================

1. Conectando a Binance...
   ✓ Cliente creado

2. Definiendo grid de parámetros a optimizar...
   ✓ Total de combinaciones: 27
   ✓ Parámetros a optimizar:
      - stoch_oversold: [20, 25, 30]
      - stoch_overbought: [70, 75, 80]
      - atr_multiplier: [1.5, 2.0, 2.5]

3. Ejecutando optimización (esto puede tardar varios minutos)...
   ACTIVO: ETH/USDT
   TIMEFRAME: 15 minutos
   DATASET: 1 año completo (365 días)
   STOP LOSS: ACTIVADO (dinámico basado en ATR)
================================================================================
Optimizando parámetros para ETHUSDT...
Estrategia: generar_senales_triple_capa
Stop Loss ATR: ACTIVADO
Total de combinaciones a probar: 27

[1/27] Probando: {'atr_length': 14, 'atr_multiplier': 1.5, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 70, 'stoch_oversold': 20, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:00:00 hasta 2025-11-04 16:45:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.16, Retorno: -33.50%

[2/27] Probando: {'atr_length': 14, 'atr_multiplier': 1.5, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 70, 'stoch_oversold': 25, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:00:00 hasta 2025-11-04 16:45:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.21, Retorno: -43.93%

[3/27] Probando: {'atr_length': 14, 'atr_multiplier': 1.5, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 70, 'stoch_oversold': 30, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:00:00 hasta 2025-11-04 16:45:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.18, Retorno: -41.49%

[4/27] Probando: {'atr_length': 14, 'atr_multiplier': 1.5, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 75, 'stoch_oversold': 20, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:00:00 hasta 2025-11-04 16:45:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.17, Retorno: -34.68%

[5/27] Probando: {'atr_length': 14, 'atr_multiplier': 1.5, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 75, 'stoch_oversold': 25, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:00:00 hasta 2025-11-04 16:45:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.21, Retorno: -44.23%

[6/27] Probando: {'atr_length': 14, 'atr_multiplier': 1.5, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 75, 'stoch_oversold': 30, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:00:00 hasta 2025-11-04 16:45:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.20, Retorno: -43.90%

[7/27] Probando: {'atr_length': 14, 'atr_multiplier': 1.5, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 80, 'stoch_oversold': 20, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35041 registros desde 2024-11-04 17:00:00 hasta 2025-11-04 17:00:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.19, Retorno: -38.13%

[8/27] Probando: {'atr_length': 14, 'atr_multiplier': 1.5, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 80, 'stoch_oversold': 25, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:15:00 hasta 2025-11-04 17:00:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.23, Retorno: -47.43%

[9/27] Probando: {'atr_length': 14, 'atr_multiplier': 1.5, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 80, 'stoch_oversold': 30, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:15:00 hasta 2025-11-04 17:00:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.21, Retorno: -45.88%

[10/27] Probando: {'atr_length': 14, 'atr_multiplier': 2.0, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 70, 'stoch_oversold': 20, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:15:00 hasta 2025-11-04 17:00:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.17, Retorno: -37.62%

[11/27] Probando: {'atr_length': 14, 'atr_multiplier': 2.0, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 70, 'stoch_oversold': 25, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:15:00 hasta 2025-11-04 17:00:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.22, Retorno: -48.04%

[12/27] Probando: {'atr_length': 14, 'atr_multiplier': 2.0, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 70, 'stoch_oversold': 30, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:15:00 hasta 2025-11-04 17:00:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.19, Retorno: -44.36%

[13/27] Probando: {'atr_length': 14, 'atr_multiplier': 2.0, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 75, 'stoch_oversold': 20, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:15:00 hasta 2025-11-04 17:00:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.20, Retorno: -41.26%

[14/27] Probando: {'atr_length': 14, 'atr_multiplier': 2.0, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 75, 'stoch_oversold': 25, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:15:00 hasta 2025-11-04 17:00:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.22, Retorno: -49.03%

[15/27] Probando: {'atr_length': 14, 'atr_multiplier': 2.0, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 75, 'stoch_oversold': 30, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:15:00 hasta 2025-11-04 17:00:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.20, Retorno: -46.86%

[16/27] Probando: {'atr_length': 14, 'atr_multiplier': 2.0, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 80, 'stoch_oversold': 20, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:15:00 hasta 2025-11-04 17:00:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.23, Retorno: -45.86%

[17/27] Probando: {'atr_length': 14, 'atr_multiplier': 2.0, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 80, 'stoch_oversold': 25, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:15:00 hasta 2025-11-04 17:00:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.26, Retorno: -53.82%

[18/27] Probando: {'atr_length': 14, 'atr_multiplier': 2.0, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 80, 'stoch_oversold': 30, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:15:00 hasta 2025-11-04 17:00:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.22, Retorno: -49.69%

[19/27] Probando: {'atr_length': 14, 'atr_multiplier': 2.5, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 70, 'stoch_oversold': 20, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:15:00 hasta 2025-11-04 17:00:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.14, Retorno: -33.99%

[20/27] Probando: {'atr_length': 14, 'atr_multiplier': 2.5, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 70, 'stoch_oversold': 25, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:15:00 hasta 2025-11-04 17:00:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.19, Retorno: -44.67%

[21/27] Probando: {'atr_length': 14, 'atr_multiplier': 2.5, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 70, 'stoch_oversold': 30, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:15:00 hasta 2025-11-04 17:00:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.18, Retorno: -44.86%

[22/27] Probando: {'atr_length': 14, 'atr_multiplier': 2.5, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 75, 'stoch_oversold': 20, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:15:00 hasta 2025-11-04 17:00:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.15, Retorno: -35.58%

[23/27] Probando: {'atr_length': 14, 'atr_multiplier': 2.5, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 75, 'stoch_oversold': 25, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:15:00 hasta 2025-11-04 17:00:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.19, Retorno: -46.71%

[24/27] Probando: {'atr_length': 14, 'atr_multiplier': 2.5, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 75, 'stoch_oversold': 30, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:15:00 hasta 2025-11-04 17:00:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.20, Retorno: -48.46%

[25/27] Probando: {'atr_length': 14, 'atr_multiplier': 2.5, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 80, 'stoch_oversold': 20, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:15:00 hasta 2025-11-04 17:00:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.18, Retorno: -39.98%

[26/27] Probando: {'atr_length': 14, 'atr_multiplier': 2.5, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 80, 'stoch_oversold': 25, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:15:00 hasta 2025-11-04 17:00:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.22, Retorno: -51.16%

[27/27] Probando: {'atr_length': 14, 'atr_multiplier': 2.5, 'bb_length': 20, 'bb_std': 2, 'ema_trend': 200, 'macd_fast': 12, 'macd_signal': 9, 'macd_slow': 26, 'rsi_period': 14, 'stoch_d': 3, 'stoch_k': 14, 'stoch_overbought': 80, 'stoch_oversold': 30, 'stoch_smooth': 3}
Descargando datos de ETHUSDT (15m) desde 365 days ago UTC...
✓ Descargados 35040 registros desde 2024-11-04 17:15:00 hasta 2025-11-04 17:00:00
/Users/jhonathan/BotDayTrading/src/indicators/technical.py:105: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method='bfill', inplace=True)
   Sharpe: -0.23, Retorno: -52.39%


4. Guardando resultados completos del Grid Search...
   ✓ Resultados guardados en: backtest_results_eth_v1_con_sl.csv
   ✓ Total de combinaciones evaluadas: 27

================================================================================
TOP 5 MEJORES CONFIGURACIONES
================================================================================

Resumen:
 ema_trend  stoch_oversold  stoch_overbought  atr_multiplier  sharpe_ratio  total_return_pct  max_drawdown_pct  win_rate_pct  profit_factor  num_trades
       200              20                70             2.5         -0.14            -33.99             40.80           0.0            0.0        2002
       200              20                75             2.5         -0.15            -35.58             42.21           0.0            0.0        1897
       200              20                70             1.5         -0.16            -33.50             39.90           0.0            0.0        2002
       200              20                70             2.0         -0.17            -37.62             44.32           0.0            0.0        2002
       200              20                75             1.5         -0.17            -34.68             41.21           0.0            0.0        1897

================================================================================
MÉTRICAS DETALLADAS DE LA MEJOR CONFIGURACIÓN
================================================================================

Parámetros Optimizados - Estrategia de 3 Capas:
  CAPA 1 (Régimen):
    - EMA Tendencia: 200 períodos
  CAPA 2 (Entrada):
    - Estocástico K: 14 períodos
    - Estocástico D: 3 períodos
    - Estocástico Smooth: 3 períodos
    - Nivel Sobreventa: 20
    - Nivel Sobrecompra: 70
  CAPA 3 (Riesgo):
    - ATR Período: 14 períodos
    - ATR Multiplicador SL: 2.5x
============================================================
MÉTRICAS DE RENDIMIENTO
============================================================

Capital Inicial:          $10,000.00
Valor Final:              $6,601.42
Ganancia Neta:            $-3,398.58
Retorno Total:            -33.99%
Retorno Anualizado:       -34.06%

Sharpe Ratio:             -0.14
Sortino Ratio:            -0.03
Calmar Ratio:             -0.83
Max Drawdown:             40.80%

Número de Trades:         2002.0
Win Rate:                 0.00%
Profit Factor:            0.0
Trade Promedio:           $-1.70
Mejor Trade:              $0.00
Peor Trade:               $-138.91
============================================================

5. Guardando parámetros óptimos...

✓ Parámetros óptimos guardados en config/optimal_params.json

================================================================================
✓ FASE 2 COMPLETADA EXITOSAMENTE - ITERACIÓN 10.1 (CON STOP LOSS)
================================================================================

Resultados:
  - CSV completo: backtest_results_eth_v1_con_sl.csv (27 combinaciones)
  - Parámetros óptimos: config/optimal_params.json
  - Stop Loss ATR: ACTIVADO (implementado correctamente)

Próximos pasos:
  - Revisar el archivo CSV para análisis completo
  - Comparar con resultados sin SL (backtest_results_eth_v1.csv)
  - Validar que la lógica de SL está funcionando correctamente
  - Si aprueba auditoría → Fase 3: python scripts/phase3_paper.py
